{"version":3,"file":"Post-2902d2df.js","sources":["../../../advanced/components/Post.svelte"],"sourcesContent":["<script lang='ts'>\n\timport type {Post} from '../database'\n\timport DB, {CommentEntity} from '../database'\n\timport {router} from '../App.svelte'\n\timport Thread from '../components/Thread.svelte'\n\texport let post: Post\n\texport let loadComments: boolean = false\n\texport let isPage: boolean = false\n\n\tlet postComments = []\n\tlet commentsOffset = 0\n\tlet commentsAvailable = true\n\tfunction fetchComments(limit = 10) {\n\t\tconst comments = DB.commentsByPost(commentsOffset, limit, post.id)\n\t\tif (comments.length < limit) {\n\t\t\tcommentsAvailable = false\n\t\t}\n\t\tcommentsOffset += limit\n\t\tpostComments = postComments.concat(comments)\n\t}\n\tif (loadComments) fetchComments(3)\n\n\tlet newComment = null\n\tfunction submitComment(): void {\n\t\tif (newComment === '') return\n\n\t\tpostComments.splice(\n\t\t\t0, 0,\n\t\t\tDB.submitComment(CommentEntity.Post, post.id, newComment),\n\t\t)\n\t\tpostComments = postComments\n\t\tnewComment = null\n\t\tcommentsOffset++\n\t}\n\n\tfunction openThisPage(): void {\n\t\trouter.push('post', {postID: post.id})\n\t}\n</script>\n\n<div class='post'>\n\t<div class='header flex flex-center-y gap-1'>\n\t\t<button on:click={()=> router.push('profile', {userID: post.userID})} class='user flex flex-center-y gap-1'>\n\t\t\t<div class='user-image flex flex-center'>\n\t\t\t\t<svg class='icon stroke' fill='none' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 120'>\n\t\t\t\t\t<path d='M103 107V96c0-14-11-25-25-25H42c-14 0-25 11-25 25v11' stroke-width='6' stroke-linecap='round'/>\n\t\t\t\t\t<circle cx='60' cy='34' r='21' stroke-width='6'/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t\t<span>{DB.userByID(post.userID).name}</span>\n\t\t\t{#if post.userID === $DB.session}\n\t\t\t\t<span class='is-session-user'>You</span>\n\t\t\t{/if}\n\t\t</button>\n\t\t{#if !isPage}\n\t\t\t<button on:click={openThisPage} class='open-page flex flex-center flex-self-right'>\n\t\t\t\t<svg class='icon stroke icon-1' viewBox='0 0 120 120' fill='none' xmlns='http://www.w3.org/2000/svg'>\n\t\t\t\t\t<path d='M57.7778 25H35C29.4772 25 25 29.4772 25 35V85C25 90.5228 29.4772 95 35 95H85C90.5228 95 95 90.5228 95 85V62.2222' stroke-width='6' stroke-linecap='round'/>\n\t\t\t\t\t<path d='M105 15L60 60M105 15L105 45M105 15L75 15' stroke-width='6' stroke-linecap='round'/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t{/if}\n\t</div>\n\t<div class='body'>\n\t\t<span class='title'>{post.title}</span>\n\t\t<p class='message'>{post.body}</p>\n\t</div>\n\t<div class='comments'>\n\t\t{#if !loadComments && postComments.length < 1 && commentsAvailable}\n\t\t\t<button on:click={()=> fetchComments(3)} class='load-comments'>\n\t\t\t\tLoad comments...\n\t\t\t</button>\n\t\t{:else}\n\t\t\t<div class='write-comment'>\n\t\t\t\t{#if newComment !== null}\n\t\t\t\t\t<button on:click={()=> newComment = null} class='discard flex flex-center'>\n\t\t\t\t\t\t<svg class='icon stroke icon-1' viewBox='0 0 120 120' fill='none' xmlns='http://www.w3.org/2000/svg'>\n\t\t\t\t\t\t\t<path d='M28.2998 91.5788L91.7007 27.7007M91.7002 91.5787L28.2993 27.7007' stroke-width='6' stroke-linecap='round'/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<textarea\n\t\t\t\t\t\trows='1'\n\t\t\t\t\t\tplaceholder='Write a comment...'\n\t\t\t\t\t\tbind:value={newComment}\n\t\t\t\t\t/>\n\t\t\t\t\t<button on:click={submitComment} class='submit flex flex-center'>\n\t\t\t\t\t\t<svg class='icon stroke icon-1' viewBox='0 0 120 120' fill='none' xmlns='http://www.w3.org/2000/svg'>\n\t\t\t\t\t\t\t<path d='M18.3604 68.6396L42.103 92.3822L105.504 28.5042' stroke-width='6' stroke-linecap='round'/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t{:else}\n\t\t\t\t\t<button on:click={()=> newComment = ''} class='write-comment-btn'>\n\t\t\t\t\t\t+ Write a comment\n\t\t\t\t\t</button>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t{#each postComments as comment}\n\t\t\t\t<Thread {comment} level={3}/>\n\t\t\t{/each}\n\t\t\t{#if commentsAvailable}\n\t\t\t\t<button class='load-comments' on:click={()=> fetchComments()}>\n\t\t\t\t\tLoad more comments...\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.open-page {\n\t\tpadding: 3px;\n\t}\n\t.post {\n\t\tpadding: 15px;\n\t\tborder-radius: 10px;\n\t\tbackground-color: var(--fg-clr);\n\t\tbox-shadow: var(--shadow);\n\t}\n\t.post .header, .post .body {\n\t\tpadding: 5px;\n\t}\n\t.post .header {\n\t\tmargin-bottom: 10px;\n\t}\n\t.post .user {\n\t\tmargin: 0;\n\t\tborder: none;\n\t\tpadding: 0;\n\t\tbackground: none;\n\t}\n\t.post .user:hover {\n\t\tcolor: var(--prime);\n\t\ttext-decoration: underline;\n\t}\n\t.post .user-image {\n\t\twidth: 30px;\n\t\theight: 30px;\n\t\tbackground-color: var(--nav-btn-hover-bg);\n\t\tborder-radius: 100%;\n\t}\n\t.post .user-image .icon {\n\t\twidth: 60%;\n\t\theight: 60%;\n\t}\n\t.post .is-session-user {\n\t\tpadding: 2px 8px;\n\t\tbox-shadow: var(--shadow);\n\t\tborder-radius: 20px;\n\t\tfont-size: .6em;\n\t\tfont-weight: 600;\n\t}\n\t.post .title {\n\t\tmargin: 0;\n\t\tcolor: var(--font-heading-clr);\n\t\tfont-weight: 600;\n\t}\n\t.post .message {\n\t\tmargin: 10px 0 0 0;\n\t\tpadding: 0;\n\t\twhite-space: pre-wrap;\n\t}\n\t.post .comments {\n\t\tpadding-right: 10px;\n\t}\n\t.post .comments .write-comment {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: auto 1fr auto;\n\t\tgrid-gap: 10px;\n\t\talign-content: start;\n\t\talign-items: start;\n\t\tmargin: 10px 0;\n\t\tfont-size: .85em;\n\t\tcolor: var(--font-heading-clr);\n\t}\n\t.post .comments .write-comment .discard .icon.stroke > * {\n\t\tstroke: var(--prime);\n\t}\n\t.post .comments .write-comment .submit .icon.stroke > * {\n\t\tstroke: var(--flash);\n\t}\n\t.post .comments .write-comment textarea {\n\t\tresize: vertical;\n\t}\n\t.post .comments .load-comments {\n\t\tmargin-top: 10px;\n\t\tpadding: 5px 10px;\n\t}\n\t.write-comment-btn {\n\t\tpadding: 5px 20px;\n\t}\n</style>\n"],"names":["router"],"mappings":"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"}